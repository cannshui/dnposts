<h2>Log4j XML 配置入门</h2>
<h3>基本示例</h3>
<p>下面是一个很基本的 log4j xml 配置文件，可以让你快速上手：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE log4j:configuration SYSTEM &quot;log4j.dtd&quot;&gt;

&lt;log4j:configuration xmlns:log4j=&quot;http://jakarta.apache.org/log4j/&quot;&gt;

    &lt;appender name=&quot;console&quot; class=&quot;org.apache.log4j.ConsoleAppender&quot;&gt;
        &lt;param name=&quot;Target&quot; value=&quot;System.out&quot;/&gt;
        &lt;layout class=&quot;org.apache.log4j.PatternLayout&quot;&gt;
            &lt;param name=&quot;ConversionPattern&quot; value=&quot;%-5p %c{1} - %m%n&quot;/&gt;
        &lt;/layout&gt;
    &lt;/appender&gt;

    &lt;root&gt;
        &lt;priority value =&quot;debug&quot; /&gt;
        &lt;appender-ref ref=&quot;console&quot; /&gt;
    &lt;/root&gt;

&lt;/log4j:configuration&gt;
</code></pre>

<p>按照上面配置，将会输出所有 <code>debug</code> 或之上级别的所有信息到屏幕控制台。注意点：</p>
<ul>
<li>首先应定义出 <code>appender</code>，必须声明 <code>name</code> 属性（这里是 <em>console</em>）。<code>appender</code> 包含一个 <code>layout</code>（这里是一个 <code>PatternLayout</code>），<code>layout</code> 包含一个 <code>pattern</code>。<code>layout</code> 的定义需满足 <code>layout</code> 规范，所以参照 javadoc 描述来准确定义你选用的 <code>layout</code> 类（<code>PatternLayout</code> 是最常用的）。</li>
<li><code>loggers</code> 在这例子中没有出现，只定义了 <code>root logger</code> 的配置（译注：<code>root</code> 本质是一个 <code>logger</code>。）。<code>root logger</code> 配置成 <code>debug</code> 级别，并把 <em>console</em> <code>appender</code> 关联到它。所有的 <code>loggers</code> 都继承至 <code>root</code>，所以这个例子中，所有 <code>loggers</code> 的 <code>deubg</code> 级别以上的信息都将输出到 <em>console</em> <code>appender</code>。</li>
</ul>
<h3>XML 配置格式</h3>
<p>为了更好的理解更细节的例子，熟悉 XML 配置文件的格式还是很有必要的。XML 语法格式定义在 log4j.dtd 中，它的位置在 log4j 二进制包下的 <code>org.apache.log4j.xml</code> 下。log4j.dtd 文件的内容不会被整个在这里列出，你可以直接打开/打印它。如果你不熟悉 xml dtd 文件格式，你最好先找本相关书籍进行查看。</p>
<p>文件开始位置附近是如下描述：</p>
<pre><code>&lt;!ELEMENT log4j:configuration (renderer*, throwableRenderer?,
                           appender*,plugin*, (category|logger)*,root?,
                           (categoryFactory|loggerFactory)?)&gt;
</code></pre>

<p>这个元素定义了 xml 文件期望的内容结构：包含 0 或多个 <code>renderer</code> 元素，0 或多个 <code>appender</code>，0 或多个 <code>logger</code> 元素，0 或一个 <code>root</code> 元素，0 或一个 <code>categoryFactory</code> 元素。元素之间出现的顺序必须按照定义中出现的顺序，否则 xml parser 在读入文件解析的时候将会打印出错误信息。小注，<code>category</code> 元素跟 <code>logger</code> 元素语义和作用相同。log4j 1.2 之前的版本，<code>loggers</code> 用 <code>category</code> 表示，所以很多的文档现在仍是沿用 <code>category</code>，记得它们是同一样东西就行了。</p>
<p>接下来， log4j.dtd 中是如下描述，定义了所允许的属性：</p>
<pre><code>&lt;!ATTLIST log4j:configuration
  xmlns:log4j              CDATA #FIXED &quot;http://jakarta.apache.org/log4j/&quot; 
  threshold                (all|trace|debug|info|warn|error|fatal|off|null) &quot;null&quot;
  debug                    (true|false|null)  &quot;null&quot;
  reset                    (true|false) &quot;false&quot;
&gt;
</code></pre>

<ul>
<li><strong>debug</strong> - 可能是 <code>log4j:configuration</code> 最重要的的属性了，设置成 <em>true</em> 将会打印读取配置文件，根据配置文件配置 <code>log4j</code> 环境这个过程的信息。在配置文件没有按照预期工作的时候，这个选项设置成 <em>true</em> 会有助于指出问题所在。</li>
<li><strong>threshold</strong> - 稍后介绍。</li>
</ul>
<p>了解 XML 配置文件的预期结构，有助于更加专注于所需要进行配置的元素。</p>
<h3><code>appender</code> 配置</h3>
<p>可以构造你的代码打印重要的调试信息，但 log4j 如果没有配置至少一个 <code>appender</code>，那么一切将是徒劳。调试信息将无从显示。</p>
<p>回顾 log4j.dtd，<code>appender</code> 元素声明如下：</p>
<pre><code>&lt;!ELEMENT appender (errorHandler?, param*,
      rollingPolicy?, triggeringPolicy?, connectionSource?,
      layout?, filter*, appender-ref*)&gt;
&lt;!ATTLIST appender
  name      CDATA   #REQUIRED
  class     CDATA   #REQUIRED
&gt;
</code></pre>

<p><code>appender</code> 元素必须设置 <em>name</em> 和 <em>class</em> 属性。<em>name</em> 用于后续配置文件中引用这个 <code>appender</code>（译注：类似于 id）。<em>class</em> 属性值需要是 <code>appender</code> 类的全类名（比如 <code>org.apache.log4j.ConsoleAppender</code>）。</p>
<p><code>appender</code> 元素可以包含子元素：</p>
<ul>
<li>0 或 1 个 <strong>errorHandler</strong> 元素 - 稍后介绍。</li>
<li>0 或多个 <strong>param</strong> 元素 - 每个 <code>appender</code> 可以设置成不同的功能。这是通过 <code>appender</code> 类中的 <code>getter</code> 和 <code>setter</code> 方法实现的。 <code>param</code> 元素用于 <code>setter</code> 方法。<code>param</code> 元素的格式很简单，它是原子元素，只有一个 <em>name</em> 属性和一个 <em>value</em> 属性。<em>name</em> 属性值是 <code>setter</code> 方法去掉 <em>set</em> 后的部分（如，方法名 <code>setTarget</code> 配置时是 <em>Target<em>）。</em>value</em> 属性是调用 <code>setter</code> 方法进行设置的值。</li>
<li>0 或 1 个 <strong>layout</strong> 元素 - 并非所有 <code>appender</code> 都需要配置一个 <code>layout</code>。对于需要配置的，<code>layout</code> 元素定义了用到的 <code>layout</code> 类。<code>layout</code> 元素只有一个属性 <em>class</em>，声明用到的 <code>layout</code> 类的全类名。与 <code>appender</code> 元素类似，<code>layout</code> 元素也可以拥有 0 或多个 <code>param</code> 子元素。同样，<code>param</code> 元素用于设置 <code>layout</code> 类的属性值，根据不同 <code>layout</code> 类会有所不同。</li>
<li>0 或多个 <strong>filter</strong> 元素 - 见<strong><a href="#Filter-Conf">过滤器配置</a></strong>小节。 </li>
<li>0 或多个 <strong>appender-ref</strong> 元素 - 稍后介绍。</li>
</ul>
<p>通过上述，简单示例中的 <em>console</em> <code>appender</code> 应该较易理解了：</p>
<pre><code>&lt;appender name=&quot;console&quot; class=&quot;org.apache.log4j.ConsoleAppender&quot;&gt;
    &lt;param name=&quot;Target&quot; value=&quot;System.out&quot; /&gt;
    &lt;layout class=&quot;org.apache.log4j.PatternLayout&quot;&gt;
        &lt;param name=&quot;ConversionPattern&quot; value=&quot;%-5p %c{1} - %m%n&quot; /&gt;
    &lt;/layout&gt;
&lt;/appender&gt;
</code></pre>

<p>这是一个 <em>console</em> <code>appender</code>。<em>console</em> 用于后续配置文件中对这个 <code>appender</code> 的引用。定义这个 <code>appender</code> 是基于 <code>org.apache.log4j.ConsoleAppender</code>。</p>
<p><em>console</em> <code>appender</code> 有一个 <code>param</code> 元素。参照 <code>ConsoleAppender</code> javadoc 可知，<code>setTarget</code> 方法用于选择日志信息输出到哪个流，<code>System.out</code> 或是 <code>System.err</code>（标准输出或标准错误流）。这个例子中配置成使用 <code>System.out</code>。</p>
<p><em>console</em> <code>appender</code> 也有一个 <code>layout</code> 元素，定义了使用 <code>org.apache.log4j.PatternLayout</code> 作为其格式化信息方式。参照 <code>PatternLayout</code> javadoc 可知，<code>setConversionPattern</code> 方法需要一个 <code>String</code> 类型参数描述日志信息输出的格式。日志信息格式化的细节参考 javadoc。</p>
<p><code>appender</code> 类的配置细节根据选择的 <code>appender</code> 类会有所不同。最好的方法是在使用时参考 <code>appender</code> 类的 javadoc 进行配置。特别注意属性的 <code>setter</code> 方法和它所需的值。每个 <code>setter</code> 方法都可以在 XML 配置文件中通过 <strong>param</strong> 元素进行配置。</p>
<p>当前，有以下可选 <code>appender</code> 类：</p>
<ul>
<li>org.apache.log4j.ConsoleAppender <a href="http://wiki.apache.org/logging-log4j/ConsoleAppender">ConsoleAppender</a></li>
<li>org.apache.log4j.FileAppender <a href="http://wiki.apache.org/logging-log4j/FileAppender">FileAppender</a></li>
<li>org.apache.log4j.JDBCAppender JDBCAppender</li>
<li>org.apache.log4j.AsyncAppender AsyncAppender</li>
<li>org.apache.log4j.net.JMSAppender <a href="http://wiki.apache.org/logging-log4j/JMSAppender">JMSAppender</a></li>
<li>org.apache.log4j.lf5.LF5Appender LF5Appender</li>
<li>org.apache.log4j.nt.NTEventLogAppender <a href="http://wiki.apache.org/logging-log4j/NTEventLogAppender">NTEventLogAppender</a></li>
<li>org.apache.log4j.varia.NullAppender NullAppender</li>
<li>org.apache.log4j.net.SMTPAppender <a href="http://wiki.apache.org/logging-log4j/SMTPAppender">SMTPAppender</a></li>
<li>org.apache.log4j.net.SocketAppender SocketAppender</li>
<li>org.apache.log4j.net.SocketHubAppender <a href="http://wiki.apache.org/logging-log4j/SocketHubAppender">SocketHubAppender</a></li>
<li>org.apache.log4j.net.SyslogAppender SyslogAppender</li>
<li>org.apache.log4j.net.TelnetAppender TelnetAppender</li>
<li>org.apache.log4j.WriterAppender WriterAppender</li>
</ul>
<h3>Logger 配置</h3>
<p>现在 <code>appenders</code> 已经配置了。但是如何配置 <code>loggers</code> 输出一个特定等级的日志信息？如何配置 <code>loggers</code> 输出日志信息到指定的 <code>appender</code>？欢迎到 <code>logger</code> 的配置。</p>
<p>你需要配置的最重要的一个 <code>logger</code> 是 <code>root logger</code>。简单示例中，是如下配置：</p>
<pre><code>&lt;root&gt;
    &lt;priority value=&quot;debug&quot; /&gt;
    &lt;appender-ref ref=&quot;console&quot; /&gt;
&lt;/root&gt;
</code></pre>

<p>上面 <code>root logger</code> 配置成输出 <em>debug</em> 及以上等级的日志信息到 <em>console</em> <code>appender</code> 中。所有的 <code>loggers</code> 都继承至 <code>root logger</code> 的设置。所以，如果没有其他的配置项，所有的 <code>loogers</code> 都将自动输出它们的日志信息到 <em>console</em> <code>appender</code>。对于简单调试这没有问题，但最终总有可能需要更加详细的配置。</p>
<p>回顾 log4j.dtd，<code>logger</code> 元素声明如下：</p>
<pre><code>&lt;!ELEMENT logger (param*,level?,appender-ref*)&gt;
&lt;!ATTLIST logger
  class         CDATA   #IMPLIED
  name      CDATA   #REQUIRED
  additivity    (true|false) &quot;true&quot;  
&gt;
</code></pre>

<blockquote>
<p>译注：我取至 log4j-1.2.16.jar 与原文有出入。</p>
</blockquote>
<p><code>logger</code> 元素必须有一个 <em>name</em> 属性，用于创建 <code>Logger</code> 实例时的名称（通常用全类名）。可以有一个可选的 <em>additivity</em> 属性，更多细节稍后介绍。</p>
<p><code>logger</code> 元素可以包含子元素：</p>
<ul>
<li>
<p>0 或 1 个 <strong>level</strong> 元素 - 定义这个 <code>logger</code> 允许进行记录的日志信息的等级。常用有 <code>debug</code>，<code>info</code>，<code>warn</code>，<code>error</code>，或 <code>fatal</code>。只有当前等级或比当前等级更高的日志信息才会报告给日志记录。</p>
</li>
<li>
<p>0 或多个 <strong>appender-ref</strong> 元素 - 用于引用一个已定义的 <code>appender</code>，当前 <code>logger</code> 将会输出日志信息到这个引用的 <code>appender</code> 中。<code>appender-ref</code> 是只有一个 <em>ref</em> 属性的简单元素，<em>ref</em> 属性值即是 <code>appender</code> 的 <em>name</em> 属性值。</p>
</li>
</ul>
<p>一个典型的 <code>logger</code> 元素配置类似与如下：</p>
<pre><code>&lt;logger name=&quot;com.mycompany.apackage.MyClass&quot;&gt;
    &lt;level value=&quot;info&quot; /&gt;
&lt;/logger&gt;
</code></pre>

<h4>Logger 继承机制</h4>
<p>稍后描述。</p>
<h4>日志叠加</h4>
<p><code>logger</code> C 的 log 操作将会输出到所有 C 中定义的 <code>appender</code> 和 C 的祖先 <code>logger</code> 中。这就是 <em>appender additivity</em> 的含义。</p>
<p>然而，如果 C 的一个祖先，比如 P，P 的 <em>additivity</em> 属性设置为 <code>false</code>，那么 C 的信息将会直接输出到 C 中定义的 <code>appender</code> 和它直到祖先 P（包括 P） 的但不包括 P 的祖先的 <code>appender</code> 中。</p>
<p><code>logger</code> 的 <em>additivity</em> 标记默认为 <em>true</em>。配置示例：</p>
<pre><code>&lt;logger name=&quot;com.eatmutton.muttonsite.torque&quot; additivity=&quot;false&quot;&gt;
    &lt;level value=&quot;info&quot; /&gt;
    &lt;appender-ref ref=&quot;local-torque&quot; /&gt;
&lt;/logger&gt;
</code></pre>

<p><code>additivity</code> 小节取自 <a href="http://logging.apache.org/log4j/docs/manual.html">http://logging.apache.org/log4j/docs/manual.html</a>。</p>
<blockquote>
<p>译注：<code>additivity</code> 没有看懂，疑问，这里所说的祖先是类中的继承关系吗？怎么构造出这样的例子呢？这也许得参考上面的链接中的内容。</p>
</blockquote>
<p>### properties 配置方式转 XML 格式</p>
<p>我将 log4j 使用文档中的配置例子转成了 xml 格式。希望能帮助有需要的人转化自己的配置文件。</p>
<p>#### 例子 1</p>
<pre><code># Set root logger level to DEBUG and its only appender to A1.
# 设置 `root logger` 的日志输出最小等级为 *DEBUG*，设置 `appender` 为 *A1*。
log4j.rootLogger=DEBUG, A1

# A1 is set to be a `ConsoleAppender`。
log4j.appender.A1=org.apache.log4j.ConsoleAppender

# A1 uses PatternLayout.
log4j.appender.A1.layout=org.apache.log4j.PatternLayout
log4j.appender.A1.layout.ConversionPattern=%-4r [%t] %-5p %c %x - %m%n
</code></pre>

<p>转化成 XML 格式如下：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE log4j:configuration SYSTEM &quot;log4j.dtd&quot;&gt;

&lt;log4j:configuration xmlns:log4j=&quot;http://jakarta.apache.org/log4j/&quot;&gt;

    &lt;!-- A1 is set to be a ConsoleAppender --&gt;
    &lt;appender name=&quot;A1&quot; class=&quot;org.apache.log4j.ConsoleAppender&quot;&gt;
        &lt;!-- A1 uses PatternLayout --&gt;
        &lt;layout class=&quot;org.apache.log4j.PatternLayout&quot;&gt;
            &lt;param name=&quot;ConversionPattern&quot; value=&quot;%-4r [%t] %-5p %c %x - %m%n&quot; /&gt;
        &lt;/layout&gt;
    &lt;/appender&gt;

    &lt;root&gt;
        &lt;!-- Set root logger level to DEBUG and its only appender to A1 --&gt;
        &lt;priority value=&quot;debug&quot; /&gt;
        &lt;appender-ref ref=&quot;A1&quot; /&gt;
    &lt;/root&gt;

&lt;/log4j:configuration&gt;
</code></pre>

<p>#### 例子 2</p>
<pre><code>log4j.rootLogger=DEBUG, A1
log4j.appender.A1=org.apache.log4j.ConsoleAppender
log4j.appender.A1.layout=org.apache.log4j.PatternLayout

# Print the date in ISO 8601 format
log4j.appender.A1.layout.ConversionPattern=%d [%t] %-5p %c - %m%n

# Print only messages of level WARN or above in the package com.foo.
# 只打印 `com.foo` 包下等级 *WARN* 及以上的日志信息。
log4j.logger.com.foo=WARN
</code></pre>

<p>转化成 XML 格式如下：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE log4j:configuration SYSTEM &quot;log4j.dtd&quot;&gt;

&lt;log4j:configuration xmlns:log4j=&quot;http://jakarta.apache.org/log4j/&quot;&gt;

    &lt;appender name=&quot;A1&quot; class=&quot;org.apache.log4j.ConsoleAppender&quot;&gt;
        &lt;layout class=&quot;org.apache.log4j.PatternLayout&quot;&gt;
            &lt;!-- Print the date in ISO 8601 format --&gt;
            &lt;param name=&quot;ConversionPattern&quot; value=&quot;%d [%t] %-5p %c - %m%n&quot; /&gt;
        &lt;/layout&gt;
    &lt;/appender&gt;

    &lt;logger name=&quot;com.foo&quot;&gt;
        &lt;!-- Print only messages of level warn or above in the package com.foo --&gt;
        &lt;level value=&quot;warn&quot; /&gt;
    &lt;/logger&gt;

    &lt;root&gt;
        &lt;priority value=&quot;debug&quot; /&gt;
        &lt;appender-ref ref=&quot;A1&quot; /&gt;
    &lt;/root&gt;

&lt;/log4j:configuration&gt;
</code></pre>

<p>#### 例子 3</p>
<pre><code>log4j.rootLogger=debug, stdout, R

log4j.appender.stdout=org.apache.log4j.ConsoleAppender
log4j.appender.stdout.layout=org.apache.log4j.PatternLayout

# Pattern to output the caller's file name and line number.
# 输出调用者（类）文件的名称和调用方法所在行号。
log4j.appender.stdout.layout.ConversionPattern=%5p [%t] (%F:%L) - %m%n

log4j.appender.R=org.apache.log4j.RollingFileAppender
log4j.appender.R.File=example.log

log4j.appender.R.MaxFileSize=100KB
# Keep one backup file
log4j.appender.R.MaxBackupIndex=1

log4j.appender.R.layout=org.apache.log4j.PatternLayout
log4j.appender.R.layout.ConversionPattern=%p %t %c - %m%n
</code></pre>

<blockquote>
<p>译注：layout 实例无法重用吗？layout 必须使用全小写，否则出现 <em>找不到</em> 报错。而简单属性首字母（只限于首字母）大小写皆可。</p>
</blockquote>
<p>转化成 XML 格式如下：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE log4j:configuration SYSTEM &quot;log4j.dtd&quot;&gt;

&lt;log4j:configuration xmlns:log4j=&quot;http://jakarta.apache.org/log4j/&quot;&gt;

    &lt;appender name=&quot;stdout&quot; class=&quot;org.apache.log4j.ConsoleAppender&quot;&gt;
        &lt;layout class=&quot;org.apache.log4j.PatternLayout&quot;&gt;
            &lt;!-- Pattern to output the caller's file name and line number --&gt;
            &lt;param name=&quot;ConversionPattern&quot; value=&quot;%5p [%t] (%F:%L) - %m%n&quot; /&gt;
        &lt;/layout&gt;
    &lt;/appender&gt;

    &lt;appender name=&quot;R&quot; class=&quot;org.apache.log4j.RollingFileAppender&quot;&gt;
        &lt;!-- 译注：最好用 File. --&gt;
        &lt;param name=&quot;file&quot; value=&quot;example.log&quot; /&gt;
        &lt;param name=&quot;MaxFileSize&quot; value=&quot;100KB&quot; /&gt;
        &lt;!-- Keep one backup file --&gt;
        &lt;param name=&quot;MaxBackupIndex&quot; value=&quot;1&quot; /&gt;
        &lt;layout class=&quot;org.apache.log4j.PatternLayout&quot;&gt;
            &lt;param name=&quot;ConversionPattern&quot; value=&quot;%p %t %c - %m%n&quot; /&gt;
        &lt;/layout&gt;
    &lt;/appender&gt;

    &lt;root&gt;
        &lt;priority value=&quot;debug&quot; /&gt;
        &lt;appender-ref ref=&quot;stdout&quot; /&gt;
        &lt;appender-ref ref=&quot;R&quot; /&gt;
    &lt;/root&gt;

&lt;/log4j:configuration&gt;
</code></pre>

<h3><a name="Filter-Conf"></a>过滤器配置</h3>
<p><code>filter</code> 可以定义在 <code>appender</code> 中。比如只过滤特定等级的日志信息，可以按照如下方式使用 <a href="http://wiki.apache.org/logging-log4j/LevelRangeFilter">LevelRangeFilter</a>：</p>
<pre><code>&lt;appender name=&quot;TRACE&quot; class=&quot;org.apache.log4j.ConsoleAppender&quot;&gt;
    &lt;layout class=&quot;org.apache.log4j.PatternLayout&quot;&gt;
        &lt;param name=&quot;ConversionPattern&quot; value=&quot;[%t] %-5p %c - %m%n&quot; /&gt;
    &lt;/layout&gt;
    &lt;filter class=&quot;org.apache.log4j.varia.LevelRangeFilter&quot;&gt;
        &lt;param name=&quot;levelMin&quot; value=&quot;DEBUG&quot; /&gt;
        &lt;param name=&quot;levelMax&quot; value=&quot;DEBUG&quot; /&gt;
    &lt;/filter&gt;
&lt;/appender&gt;
</code></pre>

<h3>高级主题</h3>
<p>稍后描述。</p>
<h3>更多示例</h3>
<p>（请在这里随意添加你的配置示例。）</p>
<p>注意，<a href="/logging-log4j/TimeBasedRollingPolicy">TimeBasedRollingPolicy</a> 只能在 XML 中配置使用，而无法在 log4j.properties 中。</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE log4j:configuration SYSTEM &quot;log4j.dtd&quot;&gt;

&lt;!-- Note that this file is refreshed by the server every 60seconds,
    as specified in web.xml --&gt;

&lt;log4j:configuration debug=&quot;true&quot;&gt;

    &lt;appender name=&quot;ROLL&quot; class=&quot;org.apache.log4j.rolling.RollingFileAppender&quot;&gt;
        &lt;!-- The active file to log to --&gt;
        &lt;param name=&quot;file&quot; value=&quot;/applogs/myportal/portal.log&quot; /&gt;
        &lt;param name=&quot;append&quot; value=&quot;true&quot; /&gt;
        &lt;param name=&quot;encoding&quot; value=&quot;UTF-8&quot; /&gt;

        &lt;rollingPolicy class=&quot;org.apache.log4j.rolling.TimeBasedRollingPolicy&quot;&gt;
            &lt;!-- The file to roll to, this is a fairly intelligent parameter, if the 
                file ends in .gz, it gzips it, based on the date stamp it rolls at that time, 
                default is yyyy-MM-dd, (rolls at midnight).
                See: http://logging.apache.org/log4j/companions/extras/apidocs/org/apache/log4j/rolling/TimeBasedRollingPolicy.html --&gt;
            &lt;param name=&quot;FileNamePattern&quot; value=&quot;/applogs/myportal/portal.%d.log.gz&quot; /&gt;
        &lt;/rollingPolicy&gt;

        &lt;layout class=&quot;org.apache.log4j.PatternLayout&quot;&gt;
            &lt;!-- The log message pattern --&gt;
            &lt;param name=&quot;ConversionPattern&quot; value=&quot;%5p %d{ISO8601} [%t][%x] %c - %m%n&quot; /&gt;
        &lt;/layout&gt;
    &lt;/appender&gt;

    &lt;!-- Loggers to filter out various class paths --&gt;
    &lt;logger name=&quot;org.hibernate.engine.loading.LoadContexts&quot; additivity=&quot;false&quot;&gt;
        &lt;level value=&quot;error&quot; /&gt;
        &lt;appender-ref ref=&quot;ROLL&quot; /&gt;
    &lt;/logger&gt;

    &lt;!-- Debugging loggers --&gt;

    &lt;!-- Uncomment to enable debug on calpoly code only --&gt;
    &lt;!--
    &lt;logger name=&quot;edu.calpoly&quot;&gt;
        &lt;level value=&quot;debug&quot; /&gt;
        &lt;appender-ref ref=&quot;ROLL&quot; /&gt;
    &lt;/logger&gt;
    --&gt;

    &lt;root&gt;
        &lt;priority value=&quot;info&quot; /&gt;
        &lt;appender-ref ref=&quot;ROLL&quot; /&gt;
    &lt;/root&gt;

&lt;/log4j:configuration&gt;
</code></pre>

<p>Log4jXmlFormat (最后编辑时间 2013-04-15 10:15:25，<a href="/logging-log4j/WikiCleaner">WikiCleaner</a>。</p>
<blockquote>
<p><strong>原文：</strong> <a href="http://wiki.apache.org/logging-log4j/Log4jXmlFormat">Log4jXmlFormat</a>。</p>
</blockquote>
<!-- This document was created with MarkdownPad, the Markdown editor for Windows (http://markdownpad.com) -->
